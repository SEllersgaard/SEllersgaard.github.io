<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="qSJUmJp4-T1Lz9aVN5PqYy0RLyyLWAThSD6RTUty4S8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Black-Scholes, Measured Carefully | Simon Ellersgaard Nielsen</title> <meta name="author" content="Simon Ellersgaard Nielsen"> <meta name="description" content="Going beyond the risk neutral probability distribution"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://sellersgaard.github.io/blog/2023/probmeasure/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Simon </span>Ellersgaard Nielsen</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Black-Scholes, Measured Carefully</h1> <p class="post-meta">March 1, 2023</p> <p class="post-tags"> <a href="/blog/2023"> <i class="fas fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/blog/tag/stochastic-calculus"> <i class="fas fa-hashtag fa-sm"></i> stochastic-calculus</a>   <a href="/blog/tag/probability"> <i class="fas fa-hashtag fa-sm"></i> probability</a>     ·   <a href="/blog/category/pricing"> <i class="fas fa-tag fa-sm"></i> pricing</a>   </p> </header> <article class="post-content"> <h3 id="the-long-and-winding-road">The long and winding road</h3> <p>For anyone who has ever gone through the trouble of deriving the <a href="https://en.wikipedia.org/wiki/Black%E2%80%93Scholes_model#Black%E2%80%93Scholes_formula" rel="external nofollow noopener" target="_blank">Black-Scholes formula</a> from first principles, this process will be recognised as tedious and requiring some attention to detail. This largely holds true, even if we assume the correctness of the <a href="https://en.wikipedia.org/wiki/Black%E2%80%93Scholes_model#Black%E2%80%93Scholes_equation" rel="external nofollow noopener" target="_blank">Black-Scholes partial differential equation</a> and the associated Feynman-Kac solution. Specifically, let us assume that the time zero value of a call option can be expressed as the expectation of the discounted payoff,</p> <p>\begin{equation}\label{call} C_0 = \mathbb{E}^{\mathbb{Q}} [ e^{-rT} (S_T-K)^+ ] , \end{equation}</p> <p>where \(\mathbb{Q}\) is defined through the Radon-Nikodym derivative</p> \[\left.{\frac{d \mathbb{Q}}{d \mathbb{P}}}\right|_t \equiv e^{ -\tfrac{1}{2} \lambda^2 t - \lambda W_t},\] <p>and \(\lambda \equiv \frac{\mu-r}{\sigma}\) is the market price of risk. We are still left with (i) determining the exact (non-relational) form risk-neutral density and (ii) evaluating the resulting integrals. As for part (i), I personally prefer taking the <a href="https://en.wikipedia.org/wiki/Law_of_the_unconscious_statistician" rel="external nofollow noopener" target="_blank">unconscious approach</a> by first expressing the terminal value of the underlying as a function of a standard normal random variable, \(Z \sim N(0,1)\), viz.</p> \[S_T(Z) = S_0 e^{ (r-\tfrac{1}{2}\sigma^2)T + \sigma \sqrt{T} Z },\] <p>which follows by applying <a href="https://en.wikipedia.org/wiki/It%C3%B4%27s_lemma#It%C3%B4_drift-diffusion_processes_(due_to:_Kunita%E2%80%93Watanabe)" rel="external nofollow noopener" target="_blank">Itô’s Lemma</a> to \(\ln S_t\). The appropriate density to use is therefore the standard normal distribution, \(\phi(z)=\frac{e^{-z^2/2}}{\sqrt{2\pi}}\).<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup> As for part (ii), we need to evaluate the integral</p> \[C_0 = e^{-rT} \int_{\mathbb{R}} \left( S_T(z) -K \right)\boldsymbol{1}\{S_T(z) \geq K\} \phi(z) dz,\] <p>where \(\boldsymbol{1}\{ \cdot\}\) is the indicator function. The \(K\) term is trivially expressed through the cumulative normal distribution. On the other hand, the \(S_T(z)\) term can only be expressed as such after we first complete the square in the exponent and then perform a change of variables. I won’t reproduce the details here, but hopefully the reader catches my drift.</p> <h3 id="whats-your-measure-sir">What’s your measure, sir?</h3> <p>What I am really trying to get at is the observation that a firm foundation in probability theory will lead us to the Black-Scholes formula faster and more elegantly. In fact, we can obtain the desired result without doing any integration whatsoever. The trick here is to think carefully about which probability measure we are using: in particular, moving beyond the mindset that all valuation must be done exclusively under the risk neutral measure.</p> <p>Recall that in the general no-arbitrage relation for contingent claims,</p> <p>\begin{equation}\label{hi} V_0 = \frac{V_0}{e^{r \cdot 0}} = \mathbb{E}^{\mathbb{Q}} \left[ \frac{V_T}{e^{rT}} \right], \end{equation}</p> <p>asset prices measured in units of the risk free asset (\(B_t=e^{rt}\)) are \(\mathbb{Q}\)-martingales. Remarkably, it transpires that <a href="https://en.wikipedia.org/wiki/Equivalence_(measure_theory)" rel="external nofollow noopener" target="_blank">equivalent probability measures</a> exist such that asset prices, measured in units of other tradeable assets, likewise are martingales. To see this, observe that the quantity</p> \[e^{rt} \frac{S_t}{S_0} = e^{-\tfrac{1}{2} \sigma^2 t + \sigma W_t^{\mathbb{Q}}},\] <p>is a positive \(\mathbb{Q}\)-martingale with unit expectation. Thus, <a href="https://en.wikipedia.org/wiki/Girsanov_theorem" rel="external nofollow noopener" target="_blank">Girsanov’s theorem</a> tells us that we can define an equivalent measure \(\mathbb{Q}^S \sim \mathbb{Q}\):</p> \[\left.{\frac{d \mathbb{Q}^S}{d \mathbb{Q}}}\right|_t \equiv e^{-rt} \frac{S_t}{S_0},\] <p>such that</p> <p>\begin{equation}\label{gs} W_t^{\mathbb{Q}^S} = W_t^{\mathbb{Q}} - \sigma t. \end{equation}</p> <p>We can therefore express \eqref{hi} as</p> \[V_0 = \int \frac{V_T}{e^{rT}} d \mathbb{Q}_T = \int \frac{V_T}{e^{rT}} e^{rT} \frac{S_0}{S_T} d\mathbb{Q}_T^S = S_0 \int \frac{V_T}{S_T} d\mathbb{Q}_T^S,\] <p>or identically</p> \[\frac{V_0}{S_0} = \mathbb{E}^{\mathbb{Q}^S} \left[ \frac{V_T}{S_T} \right],\] <p>which is what we wanted to show. As the unit of account has been changed, we refer to this process as a change of <a href="https://www.investopedia.com/terms/n/numeraire.asp" rel="external nofollow noopener" target="_blank">numeraire</a>.</p> <p>To see how this aids in the derivation of the Black-Scholes formula, let us write \eqref{call} as</p> \[C_0 = \mathbb{E}^{\mathbb{Q}}[e^{-rT} S_T \boldsymbol{1}\{S_T \geq K\}] - e^{-rT}K \mathbb{E}^{\mathbb{Q}}[ \boldsymbol{1}\{S_T \geq K\}].\] <p>The latter expectation is trivially identified as \(\mathbb{Q}(S_T \geq K)\) i.e. the risk neutral probability of the option expiring in the money. Meanwhile, for the first term, it is clearly advantageous to value the stock - not in units of the risk free asset - but rather in units of the stock itself. In other words: to perform a change of measure from \(\mathbb{Q}\) to \(\mathbb{Q}^S\). Doing so the first term becomes \(S_0 \mathbb{Q}^S(S_T \geq K)\), which is the present value of the stock, weighted by the stock-measure probability of the option expiring in the money. Jointly, we therefore have the fairly appealing pricing relation:</p> \[C_0 = S_0 \mathbb{Q}^S(S_T \geq K) - e^{-rT}K\mathbb{Q}(S_T \geq K).\] <p>Now observe that under the risk neutral measure \(\ln(S_T)\) is normally distributed with mean \(m=\ln(S_0) + (r-\tfrac{1}{2}\sigma^2)T\) and variance \(v^2 = \sigma^2T\). Letting \(Z\) be a standard normal random variable we find that</p> \[\mathbb{Q}(S_T \geq K) = \mathbb{Q}(m + vZ \geq \ln(K)) = 1-\mathbb{Q}(Z \leq \tfrac{\ln(K)-m}{v}) = \Phi(d_2),\] <p>where \(\Phi(\cdot)\) is the cumulative normal distribution, and \(d_2\) has the usual definition:</p> \[d_2 \equiv \frac{\ln(S_0/K) + (r-\tfrac{1}{2}\sigma^2)T}{\sigma \sqrt{T}}.\] <p>In a similar vein, under the stock measure \(\ln(S_T)\) is normally distributed, this time with mean \(m=\ln(S_0) + (r+\tfrac{1}{2}\sigma^2)T\) and variance \(v^2 = \sigma^2T\) (cf. eqn. \eqref{gs}). This immediately allows us to deduce</p> \[\mathbb{Q}^S(S_T \geq K) = \Phi(d_1),\] <p>where</p> \[d_1 \equiv d_2 + \sigma \sqrt{T}.\] <p>Taken together, the Black-Scholes formula is manifest:</p> \[C_0 = S_0 \Phi(d_1) - e^{-rT}K \Phi(d_2).\] <h3 id="parting-thoughts">Parting thoughts</h3> <p>Emphatically, the power of measure/numeraire changes transcends the simple example provided here. Valuing an option on a coupon bearing bond? Consider using a zero-coupon bond as a numeraire. Valuing a swaption? Using an annuity as a numeraire will make your life easier. Plenty of such examples exist, and I encourage you to explore such possibilities when tasked with a valuation exercise.</p> <div class="footnotes" role="doc-endnotes"> <ol> <li id="fn:1" role="doc-endnote"> <p>Alternatively we could keep \(S_T\) and work directly with the transition density \(d{\mathbb{Q}}(S_T \vert S_0)\). To this end, we could solve the Fokker-Planck equation as demonstrated <a href="https://en.wikipedia.org/wiki/Geometric_Brownian_motion#Properties" rel="external nofollow noopener" target="_blank">here</a>. I’ll leave it as an exercise to the reader to show that the two approaches are in fact equivalent. <a href="#fnref:1" class="reversefootnote" role="doc-backlink">↩</a></p> </li> </ol> </div> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Simon Ellersgaard Nielsen. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id="></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>